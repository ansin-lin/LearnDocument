
# 第十三章：EC2 架构 vs Serverless 架构（完整对比与架构选型）

> 本章目标：
>
> - 系统性对比传统 EC2 架构与 Serverless 架构
> - 理解两种架构在成本、复杂度、运维方面的差异
> - 掌握真实项目中的架构选型思路
> - 能在面试或方案说明中清晰说明“为什么这样选”

---

## 13.1 为什么一定要做架构选型？

在前面的章节中，你已经完整学习了两条技术路线：

- **传统云服务器架构**：EC2 / ALB / Auto Scaling / RDS  
- **Serverless 架构**：Lambda / API Gateway / S3  

这时一定会遇到一个关键问题：

> **一个新项目，到底该用哪种架构？**

📌 现实情况是：  
> **没有“最好的架构”，只有“最合适的架构”。**

---

## 13.2 两种架构的整体形态对比

### 13.2.1 传统 EC2 架构

```text
浏览器
 ↓
CloudFront（可选）
 ↓
ALB
 ↓
EC2（Spring Boot / Node）
 ↓
RDS
```

特点：

- 服务器长期运行
- 架构清晰、可控性强
- 运维成本较高

---

### 13.2.2 Serverless 架构

```text
浏览器
 ↓
API Gateway
 ↓
Lambda
 ↓
DynamoDB / RDS / S3
```

特点：

- 没有服务器管理
- 完全按需执行
- 自动扩缩容

---

## 13.3 核心维度对比（重点表格）

| 对比维度 | EC2 架构 | Serverless 架构 |
| --------- | --------- | ---------------- |
| 服务器管理 | 需要 | 不需要 |
| 运维成本 | 高 | 极低 |
| 扩缩容 | 需配置 ASG | 自动 |
| 计费方式 | 按运行时间 | 按调用次数 |
| 启动速度 | 快 | 可能冷启动 |
| 架构复杂度 | 中 | 低（小系统） |
| 长连接支持 | 好 | 差 |
| 执行时间限制 | 无 | ≤ 15 分钟 |

---

## 13.4 成本视角的真实对比

### 13.4.1 EC2 的成本特点

- 即使没有访问，也在计费
- 流量低时性价比差
- 适合 **稳定持续流量**

---

### 13.4.2 Serverless 的成本特点

- 不调用几乎不花钱
- 流量突增时自动扩容
- 高并发下成本可能快速上升

📌 经验总结：

> **低频 + 不确定流量 → Serverless 更省钱**  
> **稳定高流量 → EC2 更可控**

---

## 13.5 运维与团队能力角度

### EC2 架构更适合

- 有运维或 SRE 团队
- 对系统控制要求高
- 需要复杂运行环境

### Serverless 架构更适合

- 小团队 / 初创团队
- 希望快速上线
- 运维能力有限

---

## 13.6 真实项目中的混合架构（非常重要）

现实项目中，**纯 EC2 或纯 Serverless 都很少见**。

更常见的是：

```text
核心业务 API → EC2
边缘功能 / 异步任务 → Lambda
```

例如：

- 用户注册 / 登录 → EC2
- 图片压缩 / 邮件通知 → Lambda
- 定时清理任务 → Lambda

📌 **这才是“工程真实世界”。**

---

## 13.7 架构选型的思考顺序（面试必背）

回答“为什么选这个架构”时，可以按以下顺序说明：

1. 业务访问量是否稳定？
2. 是否需要长时间运行服务？
3. 团队是否具备运维能力？
4. 成本是否敏感？
5. 系统是否需要快速试错？

---

## 13.8 面试中的标准回答示例

> 本项目初期访问量不确定，团队规模较小，
> 因此采用 Serverless 架构以降低运维成本。
> 对于核心业务模块，仍使用 EC2 架构以保证性能和可控性，
> 通过混合架构兼顾稳定性与灵活性。

---

## 13.9 本章小结（终章总结）

- EC2 与 Serverless 各有优势
- 架构选型必须结合业务与团队
- 混合架构是主流趋势
- 能解释“为什么这样选”比“用了什么”更重要

---


# ç¬¬åç« ï¼šCloudWatch æ—¥å¿—ã€ç›‘æ§ä¸æ•…éšœæ’æŸ¥ï¼ˆç”Ÿäº§å¿…å¤‡ï¼‰

> æœ¬ç« ç›®æ ‡ï¼š
>
> - ç†è§£ CloudWatch åœ¨ AWS ä¸­çš„çœŸå®ä½œç”¨
> - æŒæ¡ç›‘æ§ï¼ˆMetricsï¼‰ä¸æ—¥å¿—ï¼ˆLogsï¼‰çš„åŒºåˆ«
> - å­¦ä¼šä¸º EC2 / ALB / RDS é…ç½®åŸºç¡€ç›‘æ§
> - èƒ½åœ¨ç³»ç»Ÿå¼‚å¸¸æ—¶ï¼Œé€šè¿‡ CloudWatch å¿«é€Ÿå®šä½é—®é¢˜

---

## 10.1 ä¸ºä»€ä¹ˆå¿…é¡»æœ‰ç›‘æ§ä¸æ—¥å¿—ï¼Ÿ

åœ¨å‰é¢çš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»æˆåŠŸï¼š

- éƒ¨ç½²äº† EC2 + Spring Boot
- ä½¿ç”¨ ALB åšç»Ÿä¸€å…¥å£
- é…ç½®äº† Auto Scaling
- å¯ç”¨äº† HTTPS

ä½†é—®é¢˜æ˜¯ï¼š

> **ä¸€æ—¦ç³»ç»Ÿå‡ºé—®é¢˜ï¼Œä½ æ€ä¹ˆçŸ¥é“ï¼Ÿ**

æ²¡æœ‰ç›‘æ§å’Œæ—¥å¿—ï¼Œç³»ç»Ÿä¼šå˜æˆï¼š

- ç”¨æˆ·è¯´â€œæ‰“ä¸å¼€äº†â€ï¼Œä½ åªèƒ½çŒœ
- æœåŠ¡æ…¢äº†ï¼Œä½†ä½ ä¸çŸ¥é“æ…¢åœ¨å“ªé‡Œ
- æœåŠ¡å™¨æŒ‚äº†ï¼Œæ²¡äººé€šçŸ¥ä½ 

ğŸ“Œ **ç»“è®ºï¼š**
> ç”Ÿäº§ç³»ç»Ÿ â‰  èƒ½è·‘  
> ç”Ÿäº§ç³»ç»Ÿ = èƒ½ç›‘æ§ + èƒ½æ’é”™

---

## 10.2 CloudWatch æ˜¯ä»€ä¹ˆï¼Ÿ

CloudWatch æ˜¯ AWS æä¾›çš„ **ç»Ÿä¸€ç›‘æ§ä¸æ—¥å¿—å¹³å°**ã€‚

å®ƒä¸»è¦è§£å†³ä¸‰ä»¶äº‹ï¼š

1. **ç›‘æ§èµ„æºçŠ¶æ€ï¼ˆMetricsï¼‰**
2. **é›†ä¸­ç®¡ç†æ—¥å¿—ï¼ˆLogsï¼‰**
3. **åŸºäºæ¡ä»¶å‘Šè­¦ï¼ˆAlarmsï¼‰**

å¯ä»¥æŠŠ CloudWatch ç†è§£ä¸ºï¼š

> **AWS ç³»ç»Ÿçš„â€œä½“æ£€ä»ªè¡¨ç›˜ + é»‘åŒ£å­â€**

---

## 10.3 Metrics ä¸ Logs çš„åŒºåˆ«ï¼ˆæ–°æ‰‹å¿…æ‡‚ï¼‰

| å¯¹æ¯”é¡¹ | Metricsï¼ˆæŒ‡æ ‡ï¼‰ | Logsï¼ˆæ—¥å¿—ï¼‰ |
| ------ | --------------- | ------------- |
| å…³æ³¨ç‚¹ | çŠ¶æ€ã€è¶‹åŠ¿ | ç»†èŠ‚ã€åŸå›  |
| æ•°æ®å½¢å¼ | æ•°å€¼ï¼ˆCPUã€å†…å­˜ï¼‰ | æ–‡æœ¬ |
| ä½¿ç”¨åœºæ™¯ | æ˜¯å¦å¼‚å¸¸ | ä¸ºä»€ä¹ˆå¼‚å¸¸ |
| ç¤ºä¾‹ | CPU ä½¿ç”¨ç‡ 90% | NullPointerException |

ğŸ“Œ **å£è¯€ï¼š**
> Metrics çœ‹â€œæœ‰æ²¡æœ‰é—®é¢˜â€ï¼ŒLogs æŸ¥â€œä¸ºä»€ä¹ˆæœ‰é—®é¢˜â€

---

## 10.4 EC2 çš„ CloudWatch ç›‘æ§

### 10.4.1 EC2 é»˜è®¤ç›‘æ§é¡¹

EC2 åˆ›å»ºåï¼ŒAWS ä¼šè‡ªåŠ¨æä¾›åŸºç¡€ç›‘æ§ï¼š

- CPUUtilizationï¼ˆCPU ä½¿ç”¨ç‡ï¼‰
- NetworkIn / NetworkOutï¼ˆç½‘ç»œæµé‡ï¼‰
- DiskReadOps / DiskWriteOps

è¿™äº›æŒ‡æ ‡ï¼š

- é»˜è®¤æ¯ 5 åˆ†é’Ÿé‡‡é›†ä¸€æ¬¡
- ä¸éœ€è¦é¢å¤–é…ç½®

---

### 10.4.2 ç›‘æ§ CPU çš„æ„ä¹‰

CPU é•¿æœŸè¿‡é«˜ï¼Œé€šå¸¸æ„å‘³ç€ï¼š

- å®ä¾‹è§„æ ¼å¤ªå°
- è¯·æ±‚é‡è¶…å‡ºæ‰¿è½½èƒ½åŠ›
- ç¨‹åºå­˜åœ¨æ­»å¾ªç¯æˆ–æ€§èƒ½é—®é¢˜

ğŸ“Œ **ç»éªŒå€¼ï¼š**
> CPU é•¿æœŸ > 70%ï¼Œéœ€è¦å…³æ³¨  
> CPU é•¿æœŸ > 85%ï¼Œå¿…é¡»å¤„ç†

---

## 10.5 ä¸º EC2 åˆ›å»ºå‘Šè­¦ï¼ˆAlarmï¼‰

### 10.5.1 å‘Šè­¦èƒ½åšä»€ä¹ˆï¼Ÿ

å½“æŒ‡æ ‡è¶…è¿‡é˜ˆå€¼æ—¶ï¼š

- å‘é€é‚®ä»¶ / SNS é€šçŸ¥
- è§¦å‘ Auto Scaling æ‰©å®¹ï¼ˆè¿›é˜¶ï¼‰

---

### 10.5.2 åˆ›å»º CPU å‘Šè­¦ï¼ˆå®æˆ˜ï¼‰

æ­¥éª¤ï¼š

1. CloudWatch â†’ Alarms â†’ Create alarm
2. é€‰æ‹© EC2 â†’ CPUUtilization
3. è®¾ç½®æ¡ä»¶ï¼š
   - Average
   - > 80%
   - æŒç»­ 5 åˆ†é’Ÿ
4. ç»‘å®š SNS é€šçŸ¥ï¼ˆé‚®ç®±ï¼‰
5. å‘½åå¹¶åˆ›å»º

è¿™æ ·ä½ å°±èƒ½ï¼š

> **åœ¨æœåŠ¡å™¨è¿˜æ²¡â€œå½»åº•æŒ‚æ‰â€å‰æ”¶åˆ°é¢„è­¦**

---

## 10.6 CloudWatch Logs æ˜¯ä»€ä¹ˆï¼Ÿ

CloudWatch Logs ç”¨äºï¼š

- é›†ä¸­å­˜å‚¨åº”ç”¨æ—¥å¿—
- è·¨å®ä¾‹ç»Ÿä¸€æŸ¥çœ‹
- æ”¯æŒæœç´¢ä¸æ—¶é—´å®šä½

åœ¨ Auto Scaling åœºæ™¯ä¸­å°¤ä¸ºé‡è¦ï¼š

> **å®ä¾‹ä¼šä¸æ–­å˜åŒ–ï¼Œæ—¥å¿—ä¸èƒ½åªå­˜åœ¨æœ¬åœ°ã€‚**

---

## 10.7 Spring Boot æ—¥å¿—æ¥å…¥ CloudWatch

### 10.7.1 ä¸ºä»€ä¹ˆä¸èƒ½åªçœ‹ EC2 æœ¬åœ°æ—¥å¿—ï¼Ÿ

- å®ä¾‹å¯èƒ½è¢«é”€æ¯
- ç™»å½•æ¯å°æœºå™¨æŸ¥çœ‹ä¸ç°å®
- æ— æ³•ç»Ÿä¸€æœç´¢

ğŸ“Œ **ç”Ÿäº§ç¯å¢ƒåŸåˆ™ï¼š**
> æ—¥å¿—å¿…é¡»é›†ä¸­åŒ–

---

### 10.7.2 æ¥å…¥æ–¹å¼æ¦‚è§ˆ

å¸¸è§åšæ³•ï¼š

```text
Spring Boot
 â†’ æœ¬åœ°æ—¥å¿—æ–‡ä»¶
 â†’ CloudWatch Agent
 â†’ CloudWatch Logs
```

---

### 10.7.3 å®‰è£… CloudWatch Agentï¼ˆEC2ï¼‰

```bash
sudo yum install -y amazon-cloudwatch-agent
```

---

### 10.7.4 é…ç½®æ—¥å¿—é‡‡é›†ï¼ˆç¤ºä¾‹ï¼‰

ç¤ºä¾‹è·¯å¾„ï¼š

```text
/var/log/springboot/app.log
```

CloudWatch é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šè¯¥è·¯å¾„å³å¯ã€‚

---

## 10.8 ALB çš„ CloudWatch ç›‘æ§

ALB è‡ªå¸¦é‡è¦æŒ‡æ ‡ï¼š

- RequestCountï¼ˆè¯·æ±‚æ•°ï¼‰
- TargetResponseTimeï¼ˆå“åº”æ—¶é—´ï¼‰
- HTTPCode_Target_5XX_Count

é‡ç‚¹å…³æ³¨ï¼š

- **5XX é”™è¯¯**
- **å“åº”æ—¶é—´çªå¢**

ğŸ“Œ è¿™äº›æŒ‡æ ‡å¸¸ç”¨äºï¼š
> åˆ¤æ–­åç«¯æ˜¯å¦å¥åº·

---

## 10.9 RDS çš„åŸºç¡€ç›‘æ§

RDS å¸¸è§ç›‘æ§é¡¹ï¼š

- CPUUtilization
- FreeableMemory
- DatabaseConnections

å¦‚æœä½ çœ‹åˆ°ï¼š

- CPU é«˜
- å†…å­˜ä½
- è¿æ¥æ•°æ»¡

è¯´æ˜æ•°æ®åº“å·²ç»æˆä¸ºç“¶é¢ˆã€‚

---

## 10.10 å¸¸è§æ•…éšœæ’æŸ¥æ€è·¯ï¼ˆéå¸¸é‡è¦ï¼‰

### åœºæ™¯ä¸€ï¼šé¡µé¢æ‰“ä¸å¼€

æ’æŸ¥é¡ºåºï¼š

1. ALB æ˜¯å¦å¥åº·
2. Target Group æ˜¯å¦æœ‰ Healthy å®ä¾‹
3. EC2 æ˜¯å¦å­˜æ´»
4. åº”ç”¨æ—¥å¿—æ˜¯å¦æŠ¥é”™

---

### åœºæ™¯äºŒï¼šæ¥å£å¾ˆæ…¢

æ’æŸ¥é¡ºåºï¼š

1. ALB å“åº”æ—¶é—´
2. EC2 CPU / å†…å­˜
3. åº”ç”¨æ—¥å¿—
4. RDS è¿æ¥ä¸æ€§èƒ½

---

## 10.11 æœ¬ç« å°ç»“

- CloudWatch æ˜¯ AWS ç›‘æ§ä¸æ—¥å¿—ä¸­æ¢
- Metrics ç”¨äºâ€œå‘ç°é—®é¢˜â€
- Logs ç”¨äºâ€œå®šä½é—®é¢˜â€
- å‘Šè­¦è®©ä½ åœ¨äº‹æ•…å‰æ”¶åˆ°é€šçŸ¥
- æ—¥å¿—é›†ä¸­åŒ–æ˜¯ç”Ÿäº§ç³»ç»Ÿå¿…å¤‡èƒ½åŠ›

---

> åˆ°è¿™é‡Œï¼Œä½ å·²ç»å…·å¤‡ï¼š
>
> - å¯è§‚æµ‹çš„ç³»ç»Ÿæ¶æ„
> - åŸºç¡€ SRE / è¿ç»´èƒ½åŠ›
> - çœŸå®ç”Ÿäº§ç¯å¢ƒçš„é—®é¢˜å®šä½èƒ½åŠ›
>
> ä¸‹ä¸€ç« å¯è‡ªç„¶è¿›å…¥ï¼š
> **Lambda / Serverless æ¶æ„** æˆ– **å®Œæ•´é¡¹ç›®æ¶æ„å¤ç›˜**
